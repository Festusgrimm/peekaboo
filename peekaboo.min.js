(function(h){var u=function(){var b={},n,m,q,r,t,u="IntersectionObserver"in h,f={},v=function(c,a,d){for(var b=0;b<c.length;b++)a.call(d,c[b])},y=function(c,a){var d=c.getBoundingClientRect(),b=d.top,g=d.left,h=d.height,f=d.width;for(c=c.parentNode;c!=document.body;){var d=c.getBoundingClientRect(),e=d.top,w=d.left;if(b<e-(h+a)||b>e+d.height+a||g<w-(f+a)||g>w+d.width+a)return!1;c=c.parentNode}return!(b<0-(h+a)||b>0+t+a||g<0-(f+a)||g>0+r+a)},z=function(c,a){var b=c.getBoundingClientRect(),k=b.top,g=b.left;return!(k<0-(b.height+a)||k>0+t+a||g<0-(b.width+a)||g>0+r+a)},x=function(c){var a=document,d=0,k=0,g,f,l,e;r=h.innerWidth;t=h.innerHeight;"undefined"===typeof m||"undefined"===typeof m.tagName?a=document:m&&(a=m);for(e in b)b.hasOwnProperty(e)&&(!0===c&&(b[e].elemList=Array.prototype.slice.call(a.querySelectorAll(e+":not([data-peekaboo])"))),g=[],k+=b[e].elemList.length,f=b[e].rootMargin,l=b[e].fastVisibilityCheck?z:y,b[e].elemList=b[e].elemList.filter(function(a){return l(a,f)?(a.setAttribute("data-peekaboo",e),g.push(a),!1):!0}),g.length&&(d+=g.length,b[e].callback(g)));0<k-d&&!n?(document.addEventListener("scroll",p,!0),h.addEventListener("resize",p),n=!0):!k&&n&&(document.removeEventListener("scroll",p),h.removeEventListener("resize",p),n=!1);q=!1},p=function(b){q||(m=b&&b.target?b.target:void 0,requestAnimationFrame(x));q=!0},A=function(c){var a;if(b.hasOwnProperty(c)&&(a=b[c].rootMargin,v(document.querySelectorAll(c),function(b){b.removeAttribute("data-peekaboo");u&&f[a].unobserve(b)}),delete b[c],f.hasOwnProperty(a))){for(c in b)if(b.hasOwnProperty(c)&&b[c].rootMargin==a)return;delete f[a]}},B=function(c){var a={},d;c.forEach(function(c){var d=c.target.getAttribute("data-peekaboo");b.hasOwnProperty(d)&&(d in a||(a[d]=[]),a[d].push(c.target),f[b[d].rootMargin].unobserve(c.target),c.target.removeAttribute("data-peekaboo"))});for(d in a)a.hasOwnProperty(d)&&b[d].callback(a[d])},l=function(c){return c?{observe:function(a){if("object"===typeof a){if("function"===!typeof a.callback)throw"No callback function passed within initialisation Object [callback]";if(!a.hasOwnProperty("pattern")||!a.pattern)throw"No CSS Selector passed within initialisation Object [pattern]";try{document.querySelectorAll(a.pattern+":not([data-peekaboo])")}catch(d){throw"Could not instantiate the CSS Selector [pattern]: "+a.pattern;}if(a.pattern in b)throw"The CSS Selector [pattern] is already being observed: "+a.pattern;b[a.pattern]={callback:a.callback,fastVisibilityCheck:!!a.fastVisibilityCheck,rootMargin:a.hasOwnProperty("rootMargin")&&parseInt(a.rootMargin,10)==a.rootMargin? a.rootMargin:150}}c(!0)},unobserve:A,supported:!0}:{observe:function(){},unobserve:function(){},supported:!1}};return"IntersectionObserver"in h?l(function(){var c,a;for(c in b)b.hasOwnProperty(c)&&(a=b[c].rootMargin,f.hasOwnProperty(a)||(f[a]=new IntersectionObserver(B,{rootMargin:a+"px"})),v(document.querySelectorAll(c+":not([data-peekaboo])"),function(b){b.setAttribute("data-peekaboo",c);f[a].observe(b)}))}):"requestAnimationFrame"in h&&"querySelectorAll"in document&&"addEventListener"in document&&"getBoundingClientRect"in document.createElement("div")?l(x):l(!1)}();h.peekaboo=u})(window);
